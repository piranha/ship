## Behavior

- **Proactive execution** - Don't ask "Can I proceed?" for implementation. DO ask before changing success criteria, test thresholds, or what "working" means.
- **Test early, test real** - Don't accumulate 10 changes then debug. After each logical step: does it work? With realistic input, not just edge case that triggered the work.
- **Tests are requirements** - Threshold in test = real-world constraint (8% video loss = can't fly). Changing test = changing spec. Always discuss first, never "fix" silently.
- **Checkpoint on confusion** - Lost why current change matters? Stop. Re-read original problem. Trace connection or revert.
- **Pushback** - Propose alternatives before implementing suboptimal approaches. Ask about design choices.
- **Direct migrations** - No backward compatibility shims or legacy aliases. Delete, don't deprecate.
- **Unify, don't duplicate** - Merge nearly-identical structs/functions rather than adding variants.
- **No over-engineering** - Minimum complexity for current task. No speculative abstractions.
- **Debugging** - Scientific method: write problem + hypotheses to `debug-<problem>.md`, design minimal experiments to falsify, track evidence, notice confusion, iterate.
- **Ownership** - Don't abandon complex/tedious work. Pause only for contradictory requirements or critical blockers.
- **Terseness** - Comments for surprising/hairy logic only. Be extremely concise in communication, sacrifice grammar.
- Address user by "Dude"

## Project Rules
- Be extremely concise in code, sacrifice grammar
- Never wall-clock timestamps - monotonic relative to session start only
- Never ever add static values to align master and slave closely, they can move in space
- Run tests before considering work complete
- Use wip.md for multi-phase work - keep enough context and plans in there to restart work if something goes wrong
- No "Generated by Claude" in commits
- **Perf**: Target ssc30kq (single-core MIPS ~400MHz). Hot path <200Âµs. Run `zig build test-perf --release=fast`
- **Tests**: Never weaken thresholds to pass. Fix problems or document why expected.
- **CLI**: kebab-case only (`--radio-port` not `--radio_port`)
- **32-bit**: usize overflow risk, use `@intCast` after bounds checks
- **No large inline arrays in structs** - Arrays >4KB in struct fields cause stack overflow if struct on stack, binary bloat, waste memory. Allocate at init(), free at deinit(). Local vars are fine (stack-allocated at runtime).
- **Bloat detection** - Use tools in `tools/` (bloat-check.sh, bloat-diff.sh, bloat-investigate.sh). No automated lint yet - manual review needed. Improve tools if bloat slips through.

## Zig 0.15

Incomplete list - add entries when agent slip-ups occur.

- `std.Thread.sleep(ns)` not `std.time.sleep`
- `@typeInfo(T).@"struct"` not `.Struct` (keywords need `@""` quoting)
- `std.io.fixedBufferStream(&buf)` lowercase
- `@intFromPtr`/`@ptrFromInt` not old `@ptrToInt`/`@intToPtr`
- Use `writer: anytype` in function signatures
